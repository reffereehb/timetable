<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Planificador de Partidos</title>
<style>
  * { box-sizing: border-box; margin:0; padding:0; }
  body { font-family: Arial, sans-serif; background:#f5f5f5; padding:15px; color:#111; }
  .container { max-width:500px; margin:auto; background:#fff; padding:20px; border-radius:10px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
  h1 { text-align:center; margin-bottom:15px; font-size:22px; }
  label { display:block; margin-top:12px; font-weight:bold; }
  input[type="time"], select, button { width:100%; padding:10px; margin-top:6px; font-size:16px; border-radius:6px; border:1px solid #ccc; }
  button { background:#2563eb; color:#fff; border:none; margin-top:10px; cursor:pointer; }
  button:hover { background:#1e40af; }
  .buttons { display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; }
  .buttons button { flex:1; }
  .table-container { overflow-x:auto; margin-top:20px; }
  table { width:100%; border-collapse:collapse; min-width:300px; }
  th, td { border:1px solid #ddd; padding:8px; text-align:center; font-size:14px; }
  th { background:#f3f3f3; }
  @media (max-width:400px){ h1{font-size:20px} input,select,button{font-size:15px;padding:8px} th,td{font-size:13px;padding:6px} }
</style>
</head>
<body>
<div class="container">
  <h1>Planificador de Partidos</h1>

  <label for="hora">Hora del partido (24h):</label>
  <input type="time" id="hora">

  <label for="tipo">Tipo:</label>
  <select id="tipo">
    <option value="base">Base</option>
    <option value="nacional">Nacional</option>
  </select>

  <div class="buttons">
    <button onclick="generar()">Generar tabla</button>
    <button onclick="window.print()">Imprimir / PDF</button>
    <button onclick="copiarTabla()">Copiar tabla</button>
    <button onclick="generarImagen()">Generar imagen</button>
  </div>

  <div class="table-container" id="tablaContainer">
    <table id="tabla"></table>
  </div>
</div>

<!-- Librería para capturar la tabla como imagen -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
function generar() {
  const horaInput = document.getElementById("hora").value;
  const tipo = document.getElementById("tipo").value;
  if (!horaInput) return alert("Pon una hora");

  const [h, m] = horaInput.split(":").map(Number);
  const partido = new Date();
  partido.setHours(h,m,0,0);

  const tareasBase = [
    { offset:-45,texto:"Llegar al pabellón, dejar cosas y café"},
    { offset:-30,texto:"Cambiarse y dejar todo preparado"},
    { offset:-20,texto:"Calentar"},
    { offset:-10,texto:"Sorteo"},
    { offset:-5,texto:"Cambiarse"},
    { offset:0,texto:"Presentación y después hablamos"}
  ];

  const tareasNacional = [
    { offset:-60,texto:"Llegar, hablar con la mesa y pedir llave del vestuario"},
    { offset:-45,texto:"Cambiarse y dejar todo preparado"},
    { offset:-35,texto:"Sorteo y calentar"},
    { offset:-15,texto:"Cambiarse y pinganillos"},
    { offset:-5,texto:"Presentación y después hablamos"}
  ];

  const tareas = tipo==="base"?tareasBase:tareasNacional;

  const tabla = document.getElementById("tabla");
  tabla.innerHTML="<tr><th>Hora</th><th>Actividad</th></tr>";
  tareas.forEach(t=>{
    const horaTarea = new Date(partido.getTime()+t.offset*60000);
    const hh = horaTarea.getHours().toString().padStart(2,"0");
    const mm = horaTarea.getMinutes().toString().padStart(2,"0");
    tabla.innerHTML+=`<tr><td>${hh}:${mm}</td><td>${t.texto}</td></tr>`;
  });
}

function copiarTabla(){
  const tabla = document.getElementById("tabla");
  if(!tabla.innerText){ alert("Genera la tabla primero"); return; }
  navigator.clipboard.writeText(tabla.innerText).then(()=>alert("Tabla copiada al portapapeles"));
}

function generarImagen(){
  const tablaContainer = document.getElementById("tablaContainer");
  html2canvas(tablaContainer).then(canvas=>{
    const link = document.createElement('a');
    link.download = 'tabla_partido.png';
    link.href = canvas.toDataURL();
    link.click();
  });
}
</script>
</body>
</html>
